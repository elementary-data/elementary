elementary_tests:
  target: postgres
  outputs: &outputs

    # ── Docker targets (plaintext, no secrets needed) ──────────────────

    postgres:
      type: postgres
      host: 127.0.0.1
      port: 5432
      user: admin
      password: admin
      dbname: postgres
      schema: ${SCHEMA_NAME}
      threads: 32

    clickhouse:
      type: clickhouse
      host: localhost
      port: 8123
      user: default
      password: default
      schema: ${SCHEMA_NAME}
      threads: 4

    # ── Cloud targets (secrets substituted at CI time) ─────────────────

    snowflake:
      type: snowflake
      account: ${SNOWFLAKE_ACCOUNT}
      user: ${SNOWFLAKE_USER}
      password: ${SNOWFLAKE_PASSWORD}
      role: ${SNOWFLAKE_ROLE}
      database: ${SNOWFLAKE_DATABASE}
      warehouse: ${SNOWFLAKE_WAREHOUSE}
      schema: ${SCHEMA_NAME}
      threads: 4

    bigquery:
      type: bigquery
      method: service-account
      project: ${BIGQUERY_PROJECT}
      dataset: ${SCHEMA_NAME}
      keyfile: ${BIGQUERY_KEYFILE_PATH}
      threads: 4

    redshift:
      type: redshift
      host: ${REDSHIFT_HOST}
      user: ${REDSHIFT_USER}
      password: ${REDSHIFT_PASSWORD}
      port: ${REDSHIFT_PORT}
      dbname: ${REDSHIFT_DBNAME}
      schema: ${SCHEMA_NAME}
      threads: 4

    databricks_catalog:
      type: databricks
      host: ${DATABRICKS_HOST}
      http_path: ${DATABRICKS_HTTP_PATH}
      catalog: ${DATABRICKS_CATALOG}
      schema: ${SCHEMA_NAME}
      client_id: ${DATABRICKS_CLIENT_ID}
      client_secret: ${DATABRICKS_CLIENT_SECRET}
      threads: 4

    spark:
      type: spark
      method: http
      host: ${SPARK_HOST}
      token: ${SPARK_TOKEN}
      cluster: ${SPARK_CLUSTER}
      schema: ${SCHEMA_NAME}
      threads: 4

    athena:
      type: athena
      s3_staging_dir: ${ATHENA_S3_STAGING_DIR}
      s3_data_dir: ${ATHENA_S3_DATA_DIR}
      region_name: ${ATHENA_REGION}
      database: awsdatacatalog
      schema: ${SCHEMA_NAME}
      aws_access_key_id: ${ATHENA_AWS_ACCESS_KEY_ID}
      aws_secret_access_key: ${ATHENA_AWS_SECRET_ACCESS_KEY}
      threads: 4

# The internal CLI dbt_project uses profile "elementary", so we alias the same outputs.
elementary:
  target: postgres
  outputs: *outputs
